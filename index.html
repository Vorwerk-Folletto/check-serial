<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <link rel="manifest" href="manifest.json?v=3">
  <title>Folletto Tool</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Anti-cache -->
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />

  <!-- Auto fix PWA -->
  <script>
    (function () {
      const VERSION = "3";
      const url = new URL(window.location.href);
      if (url.searchParams.get("v") !== VERSION) {
        url.searchParams.set("v", VERSION);
        window.location.replace(url.toString());
        return;
      }
    })();
  </script>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    :root{
      --g1:#25d366;
      --g2:#1ebea5;
      --b1:#25788f;
      --bg1:#e9f2f7;
      --bg2:#e2e8ec;
      --txt:#102a33;
      --muted:#6a7e86;
      --danger:#c91818;
    }
    body{
      margin:0;
      font-family: Arial, sans-serif;
      background: linear-gradient(135deg,var(--bg1),var(--bg2));
      text-align:center;
    }

    /* PASSWORD */
    #passwordOverlay{
      position:fixed; inset:0;
      background:linear-gradient(160deg,#e8fdf3,#d1f5ea);
      display:flex; align-items:center; justify-content:center;
      z-index:9999;
    }
    #passwordBox{
      background:#fff;
      padding:28px 22px;
      border-radius:18px;
      width:min(380px,90vw);
      box-shadow:0 12px 48px rgba(0,0,0,.16);
    }
    #passwordInput{
      width:100%;
      padding:12px;
      font-size:18px;
      border-radius:10px;
      border:1.5px solid #bde4cf;
      text-align:center;
    }
    .btnMain{
      margin-top:10px;
      width:100%;
      padding:13px 0;
      font-size:20px;
      font-weight:900;
      border:none;
      border-radius:10px;
      background:linear-gradient(90deg,var(--g1),var(--g2));
      color:#fff;
    }
    #passwordError{
      display:none;
      color:var(--danger);
      font-weight:900;
      margin-top:10px;
    }

    /* Ricorda password */
    .rememberRow{
      margin-top:12px;
      display:flex;
      align-items:center;
      justify-content:center;
      gap:10px;
      font-size:14px;
      font-weight:900;
      color:var(--muted);
    }
    .rememberRow input{
      transform:scale(1.2);
      accent-color:var(--g1);
    }

    /* MENU */
    #menu{
      display:none;
      padding:30px 14px;
      max-width:600px;
      margin:auto;
    }
    .card{
      background:#fff;
      padding:20px;
      border-radius:18px;
      margin:14px 0;
      box-shadow:0 12px 40px rgba(0,0,0,.08);
      font-weight:900;
      font-size:18px;
      cursor:pointer;
    }
    .logout{
      background:#111;
      color:#fff;
    }
  </style>
</head>

<body>

<!-- LOGIN -->
<div id="passwordOverlay">
  <div id="passwordBox">
    <h2>Accesso riservato</h2>
    <input type="password" id="passwordInput" placeholder="Inserisci password">

    <div class="rememberRow">
      <input type="checkbox" id="rememberMe">
      <label for="rememberMe">Ricorda password</label>
    </div>

    <button class="btnMain" onclick="checkPassword()">Entra</button>
    <div id="passwordError">Password errata ‚ö†Ô∏è</div>
  </div>
</div>

<!-- MENU -->
<div id="menu">
  <div class="card" onclick="goSerial()">üîç Serial Check</div>
  <div class="card" onclick="goAttivita()">üìã Attivit√†</div>
  <div class="card logout" onclick="logout()">Esci</div>
</div>

<script>
  const ACCESS_PASSWORD = "1232";
  const REMEMBER_KEY = "folletto_remember";
  const AUTH_KEY = "auth_ok";

  function checkPassword(){
    const pwd = document.getElementById("passwordInput").value.trim();
    if(pwd === ACCESS_PASSWORD){
      localStorage.setItem(AUTH_KEY,"1");
      if(document.getElementById("rememberMe").checked){
        localStorage.setItem(REMEMBER_KEY,"1");
      }
      showMenu();
    }else{
      document.getElementById("passwordError").style.display="block";
    }
  }

  function showMenu(){
    document.getElementById("passwordOverlay").style.display="none";
    document.getElementById("menu").style.display="block";
  }

  function logout(){
    localStorage.removeItem(AUTH_KEY);
    localStorage.removeItem(REMEMBER_KEY);
    location.href="index.html?v=3";
  }

  function goSerial(){ location.href="serial.html?v=3"; }
  function goAttivita(){ location.href="attivita.html?v=3"; }

  document.addEventListener("DOMContentLoaded",()=>{
    if(localStorage.getItem(REMEMBER_KEY)==="1" && localStorage.getItem(AUTH_KEY)==="1"){
      showMenu();
    }
  });
</script>

</body>
</html>